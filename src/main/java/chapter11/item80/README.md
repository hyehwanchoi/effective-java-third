# 스레드보다는 실행자, 태스크, 스트림을 애용하라

* `java.util.concurrent` 패키지는 실행자 프레임워크라고 하는 인터페이스 기반의 유연한 태스크 실행 기능을 담고 있다.
````
* 작업 큐 생성
ExecutorService exec = Executors.newSingletonThreadExecutor();

* 실행자에 실행할 태스크를 넘기는 방법
exec.execute(runnable);

* 실행자 종료
exec.shutdown(runnable)
````

### 실행자 서비스의 기능
* 특정 태스크가 완료되기를 기다린다.
* 태스크 모음 중 아무것 하나 혹은 모든 태스크가 완료되기를 기다린다.
* 실행자 서비스가 종료하기를 기다린다.
* 완료된 태스크들의 결과를 차례로 받는다.
* 태스크를 특정 시간에 혹은 주기적으로 실행하게 한다.

####
* 큐를 둘 이상의 스레드가 처리하게 하고 싶다면 정적 팩터리를 이용하여 다른 종류의 실행자 서비스를 생성하면 된다.
* 스레드 풀의 스레드 개수는 설정할 수 있다.
* 자근 프로그램이나 가벼운 서버라면 Executors.newCachedThreadPool 을 선택하는 것이 좋다.
  * CachedThreadPool 에서는 요청받은 태스크들이 큐에 쌓이지 않고 즉시 스레드에 위임돼 실행된다.
  * 가용한 스레드가 없다면 새로 하나를 생성한다.
  * 따라서 무거운 프로덕션 서버에서는 스레드 개수를 고정한 Executors.newFixedThreadPool 을 선택하거나 완전히 통제할 수 있는 ThreadPoolExecutor 를 사용하는 것이 좋다.
* 작업 큐를 손수 만드는 일은 삼가야 하고, 스레드를 직접 다루는 것도 일반적으로 삼가야 한다.
* 태스크에는 두 가지가 있다.
  * Runnable, Callable
  * Callable 은 Runnable 과 비슷하지만 값을 반환하고 임의의 예외를 던질 수 있다.
* 자바 7이 되면서 포크-조인 태스크를 지원하도록 확장되었다.
  * 작은 하위 태스크로 나뉠 수 있고, ForkJoinPool 을 궝하는 스레드들이 이 태스크들을 처리하며,
    일을 먼저 끝낸 스레드는 다른 스레드의 남은 태스크를 가져와 대신 처리할 수도 있다.
  * CPU 를 최대한 활용하면서 높은 처리량과 낮은 지연시간을 달성한다.
  * 포크-조인 풀을 이용해 만든 병렬 스트림을 이용하면 적은 노력으로 그 이점을 얻을 수 있다.