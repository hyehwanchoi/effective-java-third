# 공유 중인 가변 데이터는 동기화해 사용하라

* 동기화를 제대로 사용하면 객체의 상태가 일관된다.
* 동기화는 배타적 실행뿐 아니라 스레드 사이의 안정적인 통신에 꼭 필요하다.
* 쓰기와 읽기 모두 동기화되지 않으면 동작을 보장하지 않는다.

### 다른 스레드를 멈추는 올바른 방법
* Thread.stop 은 사용하지 말자. 
* boolean 필드를 폴링하면서 그 값이 true 가 되면 멈춘다. 
  * 이 필드를 false 로 초기화해놓고, 다른 스레드에서 이 스레드를 멈추고자 할 때 true 로 변경하는 식이다.

### 객체를 안전하게 발행하는 방법
1. 클래스 초기화 과정에서 객체를 정적 필드, volatile 필드, final 필드, 락을 통해 접근 하는 필드에 저장한다.
2. 동시성 컬렉션에 저장한다.

####
    * volatile : 최근에 기록된 값을 읽게 됨을 보장
    * 안전 실패 : 프로그램이 잘못된 결과를 계산해내는 오류
    * 사실상 불변 : 다른 스레드들은 동기화 없이 자유롭게 값을 읽는 것
    * 안전 발행 : 다른 스레드에 사실상 불변인 객체를 건네는 행위

### 정리
* 가변 데이터는 단일 스레드에서만 쓰도록 하자.
* 문서에 남겨 유지보수 과정에서도 정책이 계속 지켜지도록 하는 게 중요하다.