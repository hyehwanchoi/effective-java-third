# 지연 초기화는 신중히 사용하라

* 지연 초기화는 필드의 초기화 시점을 그 값이 처음 필요할 때까지 늦추는 기법이다.
* 지연 초기화는 주로 최적화 용도로 쓰이지만, 클래스와 인스턴스 초기화 때 발생하는 위험한 순환 문제를 해결하는 효과도 있다.
* 성능을 느리게 할 수 있으므로, 필요할 때까지는 하지 말자.
* 지연 초기화가 필요할 때는 필드를 사용하는 인스턴스의 비율이 낮은 반면, 그 필드를 초기화하는 비용이 클 때이다.
* 대부분의 상황에서 일반적인 초기화가 지연 초기화보다 낫다.
* 지연 초기화가 초기화 순환성을 깨뜨릴 것 같으면 synchronized 를 단 접근자를 사용하라.
* 성능 때문에 적정 필드를 지연 초기화해야 한다면 지연 초기화 홀더 클래스 관용구를 사용하라.
* 성능 때문에 인스턴스 필드를 지연 초기화해야 한다면 이중검사 관용구를 사용하라.
  * 동기화 비용을 없애준다.
  * 필드가 초기화된 후로는 동기화하지 않으므로 해당 필드는 반드시 volatile 로 선언해야 한다.
  ````
  private volatile FieldType field;
  
  private FieldType getField() {
    // result 변수는 필드가 이미 초기화된 상황에서는 그 필드를 딱 한 번만 읽도록 보장하는 역할을 한다.
    FieldType result = field; 
    if(result != null) { // 첫 번째 검사 (락 사용 안함)
        return result;
    }
  
    synchronized(this) {
      if(field == null) // 두 번째 검사 (락 사용)
        field = computeFieldValue();
      return field;
    }
  }
  
  * 반복해서 초기화해도 상관없는 인스턴스 필드는 단일 검사 관용구도 고려 대상이다.
  ````

