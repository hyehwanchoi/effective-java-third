# 가능한 한 실패 원자적으로 만들라

* 호출된 메서드가 실패하더라도 해당 객체는 메서드 호출 전 상태를 유지해야 한다. (=실패 원자적)

### 메서드를 실패 원자적으로 만드는 방법
* 가장 간단한 방법은 불변 객체로 설계하는 것이다.
* 가변 객체의 메서드를 실패 원자적으로 만드는 가장 흔한 방법은 매개변수의 유효성을 검사하는 것이다.
* 객체의 임시 복사본에서 작업을 수행한 다음, 작업이 성공적으로 완료되면 원래 객체와 교체하는 것이다.
  * 데이터를 임시 자료구조에 저장해 작업하는 게 더 빠를 때 적용하기 좋은 방식이다.
* 작업 도중 발생하는 실패를 가로채는 복구 코드를 작성하여 작업 전 상태로 되돌리는 방법이다.
  * 주로 내구성을 보장해야 하는 자료구조에 쓰이는데, 자주 쓰진 않는다.

### 정리
* 실패 원자성은 항상 달성할 수 있는 것은 아니다.
* 이 규칙을 지키지 못한다면 실패 시의 객체 상태를 API 설명에 명시해야 한다.